<!DOCTYPE html>
<html>
<head>
	<script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
	<script src="https://raw.githack.com/jeromeetienne/AR.js/2.0.8/aframe/build/aframe-ar.js"></script>
</head>
<body>
<!--   <a-scene stats embedded arjs='trackingMethod: best; debugUIEnabled: false'>
        <a-marker preset="hiro">
        <a-box position='0 1 0' material='color: blue;'>
        </a-box>
        </a-marker>
        <a-entity camera></a-entity>
  </a-scene> -->

    <script>
      //Multi Markers WebAR-AR.js and Aframe - Playing the Archive - Connected Environment CASA-UCL

      //Global Variable
      var markersURLArray=[];
      var markersNameArray=[];

      AFRAME.registerComponent('markers_start',{
        init:function(){
          console.log('Add markers to the scene');

          var sceneEl = document.querySelector('a-scene');
          
          //list of the markers
          for(var i=1; i<6; i++)
          {
            var url="resources/markers/pattern-Individual_Blocks-"+i+".patt";
            markersURLArray.push(url);
            markersNameArray.push('Marker_'+i);
            //console.log(url);
          }

          for(var k=0; k<5; k++)
          {
            var markerEl = document.createElement('a-marker');
            markerEl.setAttribute('type','pattern');
            markerEl.setAttribute('url',markersURLArray[k]);
            markerEl.setAttribute('id',markersNameArray[k]);

            markerEl.setAttribute('registerevents','');
            sceneEl.appendChild(markerEl);

            //Adding a plane to each marker
            var panelE = document.createElement('a-plane');

            panelE.setAttribute('height','6');
            panelE.setAttribute('width','10');
            panelE.setAttribute('material','#color: blue; opacity: 0.1; transparent: true');
            panelE.object3D.position.set(-5, -3, 0);

            markerEl.appendChild(panelE);

            //<a-plane position="-7 4 -10" rotation="30 20 45" width="10" height="1.5" color="#F16745" geometry="" material="color: blue; opacity: 0.1; transparent: true"></a-plane>

            //Adding text to each marker
            var textEl = document.createElement('a-entity');
            
            textEl.setAttribute('id','text');
            textEl.setAttribute('text',{color: 'red', align: 'center', value:markersNameArray[k], width: '5.5'});
            textEl.object3D.position.set(0, 0.7, 0);
            textEl.object3D.rotation.set(90, 0, 0);

            markerEl.appendChild(textEl);
          }
        }
      });


      //Detect marker found and lost
      AFRAME.registerComponent('registerevents', {
          init: function () {
            const marker = this.el;

            marker.addEventListener("markerFound", ()=> {
              var markerId = marker.id;
              console.log('Marker Found: ', markerId);
            });

            marker.addEventListener("markerLost",() =>{
              var markerId = marker.id;
              console.log('Marker Lost: ', markerId);
            });
          },
        });

        </script> 
        


<!--     <a-scene markers_start vr-mode-ui="enabled: false" color-space="sRGB" renderer="gammaOutput: true"
            embedded arjs='debugUIEnabled: false; sourceType: webcam; patternRatio: 0.85; trackingMethod: best;'> -->
          <a-scene markers_start altspace="" scale="0.1 0.1 0.1" class="fullscreen" canvas="" inspector="" keyboard-shortcuts="" vr-mode-ui="">  
                <!-- <a-entity id='userCamera' camera> -->
              <!-- <a-cursor> </a-cursor> -->
                <!-- </a-entity> -->
            </a-scene> 
</body>
</html>
